name: Trigger Netlify Build (Simple Method)

on:
  # æ¯Žæ—¥åˆå‰6æ™‚ï¼ˆJSTï¼‰ã«å®Ÿè¡Œ
  schedule:
    - cron: '0 21 * * *' # UTC 21:00 = JST 6:00AM
  # æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼
  workflow_dispatch:
    inputs:
      reason:
        description: 'ãƒ“ãƒ«ãƒ‰ãƒˆãƒªã‚¬ãƒ¼ç†ç”±'
        required: false
        default: 'Manual trigger'
        type: string

jobs:
  trigger-build:
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
      - name: Trigger Netlify Build via Build Hook
        run: |
          echo "ðŸš€ Netlifyãƒ“ãƒ«ãƒ‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ä¸­..."
          echo "ç†ç”±: ${{ github.event.inputs.reason || 'Scheduled trigger' }}"

          # Build Hookã‚’å‘¼ã³å‡ºã—
          curl -X POST -d '{}' ${{ secrets.NETLIFY_BUILD_HOOK_URL }}

          echo "âœ… ãƒ“ãƒ«ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã—ãŸ"
          echo "ðŸŒ ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³: https://app.netlify.com/projects/keiba-nyumon/deploys"

      - name: Wait and verify
        run: |
          echo "â³ Netlifyã§ãƒ“ãƒ«ãƒ‰ä¸­..."
          echo "ðŸ“‹ æ•°åˆ†å¾Œã«ã‚µã‚¤ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„: https://keiba-nyumon.netlify.app"

      - name: Summary
        run: |
          echo "### ðŸ“Š ãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒžãƒªãƒ¼" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Netlifyãƒ“ãƒ«ãƒ‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã—ãŸ" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸŒ ã‚µã‚¤ãƒˆ: https://keiba-nyumon.netlify.app" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ“… å®Ÿè¡Œæ—¥æ™‚: $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ­ã‚°: https://app.netlify.com/projects/keiba-nyumon/deploys" >> $GITHUB_STEP_SUMMARY
